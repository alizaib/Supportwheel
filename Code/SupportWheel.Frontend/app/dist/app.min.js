"use strict";!function(){angular.module("components.about",[]).component("swAbout",{templateUrl:"app/components/about/about.html",controller:function(){},bindings:{}})}(),function(){angular.module("components.core.auth",["shared.services.service.security"]).directive("auth",function(){return{restrict:"E",controller:"AuthController",templateUrl:"app/components/core/auth/auth.html",controllerAs:"auth"}}).controller("AuthController",e);e.$inject=["securityService"];function e(e){this.currentUser=e.currentUser,this.isAuthenticated=e.isAuthenticated,this.logout=e.logout,this.showLogin=e.showLogin}}(),function(){angular.module("components.core.authenticatedMenu",["shared.services.service.security"]).directive("authenticatedMenu",function(){return{restrict:"E",controller:"AuthenticatedMenuController",templateUrl:"app/components/core/authenticatedMenu/authenticatedMenu.html",controllerAs:"authMenu"}}).controller("AuthenticatedMenuController",e);e.$inject=["securityService"];function e(e){this.isAuthenticated=e.isAuthenticated}}(),function(){angular.module("components.core.chooseLanguage",["shared.services.service.culture"]).directive("chooseLanguage",function(){return{restrict:"E",controller:"ChooseLanguageController",templateUrl:"app/components/core/chooseLanguage/chooseLanguage.html",controllerAs:"language"}}).controller("ChooseLanguageController",e);e.$inject=["cultureService"];function e(e){this.changeLanguage=function(t){e.setCulture(t)},this.getName=function(){var t=e.getCulture();return void 0!=t?t.name:"Clique para escolher um idioma"}}}(),describe("Component: chooseLanguage",function(){var e,t,n;beforeEach(module("components.core.chooseLanguage","templates")),beforeEach(module("shared.services.service","ngStorage","ngMaterial","pascalprecht.translate")),beforeEach(inject(function(t,n,o){scope=t.$new(),e=n,o.$reset()})),describe("Directive",function(){beforeEach(inject(function(e){t=e,n=function(){var e=angular.element("<body><choose-language/><body>"),n=t(e)(scope);return scope.$digest(),n}()})),it("expect template to be created",function(){expect(n.html()).not.toEqual("");var e=n.find("md-menu").children("button");expect(e.length).toEqual(1)})}),describe("Controller",function(){it("expect chooseLanguage controller to be initialized",function(){var t=e("ChooseLanguageController",{$scope:scope});scope.vm=t,expect(t).toBeDefined()}),it("expect changeLanguage to be working",function(){var t=e("ChooseLanguageController",{$scope:scope});scope.vm=t,expect(scope.vm.getName()).toBeUndefined(),scope.vm.changeLanguage("en-US"),scope.$digest(),expect(scope.vm.getName()).toBe("English")}),it("expect getName to be Undefined if set with an unknown language",function(){var t=e("ChooseLanguageController",{$scope:scope});scope.vm=t,scope.vm.changeLanguage("en-US"),scope.$digest(),expect(scope.vm.getName()).toBe("English"),scope.vm.changeLanguage("xx"),scope.$digest(),expect(scope.vm.getName()).toBeUndefined()})})}),function(){angular.module("components.core.createTabs",[]).directive("createTabs",function(){return{restrict:"E",controller:"CreateTabsController",templateUrl:"app/components/core/createTabs/createTabs.html",controllerAs:"createTabs",scope:{},bindToController:{tabs:"<?",title:"<?",currentView:"<?"}}}).controller("CreateTabsController",e);e.$inject=["$state","$location","$scope"];function e(e,t,n){var o=this;o.onTabSelected=function(e){o.currentTab=_.findIndex(o.tabs,{tabViewName:e.tabViewName})},n.$on("$stateChangeSuccess",function(){i()}),i();function i(){o.currentTab=0,void 0!=o.currentView&&_.findIndex(o.tabs,{tabViewName:o.currentView})>-1?o.currentTab=_.findIndex(o.tabs,{tabViewName:o.currentView}):_.forEach(o.tabs,function(t,n){_.indexOf(t.tabStates,e.current.name)>-1&&(o.currentTab=n)})}n.$watch(function(){return{currentView:o.currentView}},function(e,t){e!==t&&i()},!0)}}(),describe("Component.Core: createTabs",function(){var e,t,n,o,i;beforeEach(module("components.core.createTabs","templates")),beforeEach(module("shared.services.service","ngStorage","ngMaterial","ui.router","pascalprecht.translate")),beforeEach(inject(function(r,a,c){scope=r.$new(),e=c;t=function(t){var n=angular.element("<body>"+t+"</body"),o=e(n)(scope);return scope.$digest(),o}('<create-tabs title="title" tabs="tabs"></create-tabs>'),n="createTabs",o="createTabs",i=t.isolateScope()})),it("expect template to be replaced",function(){expect(t.find("md-card").length).toBe(1)}),it("expect controller to be defined",function(){var e=t.controller(o);expect(e).toBeDefined()}),it("expect controllerAs name to be right",function(){expect(i.hasOwnProperty(n)).toBeTruthy()}),it('expect parameter: "title" to be set',function(){scope.title="Tab Title";var e=i[n];expect(e.title).toBeUndefined(),scope.$digest(),expect(e.title).toBe("Tab Title")}),it("expect directive to render a title",function(){scope.title="Tab Title",scope.$digest(),expect(t.children("md-card").children("md-toolbar").children("div").children("span").html()).toBe("Tab Title")}),it('expect parameter: "tabsList" to be set',function(){scope.tabs=[{tabName:"TabName1",tabIcon:"tabIcon1",tabViewName:"tabViewName1",tabState:"tabState1",disabled:!1},{tabName:"TabName2",tabIcon:"tabIcon2",tabViewName:"tabViewName2",tabState:"tabState2",disabled:!1}];var e=i[n];expect(e.tabs).toBeUndefined(),scope.$digest(),expect(e.tabs).toBeDefined(),expect(e.tabs.length).toBe(2)}),it("expect directive to render right number of tabs",function(){var e=[{tabName:"TabName1",tabIcon:"tabIcon1",tabViewName:"tabViewName1",tabState:"tabState1"},{tabName:"TabName2",tabIcon:"tabIcon2",tabViewName:"tabViewName2",tabState:"tabState2"}];scope.tabs=e,scope.$digest(),expect(t.find("md-tab").length).toBe(2),e.push({tabName:"TabName3",tabIcon:"tabIcon3",tabViewName:"tabViewName3",tabState:"tabState3"}),scope.$digest(),expect(t.find("md-tab").length).toBe(3)}),it("expect template to have the right properties name/values",function(){var e=[{tabName:"TabName1",tabIcon:"tabIcon1",tabViewName:"tabViewName1",tabUrl:"/state1"},{tabName:"TabName2",tabIcon:"tabIcon2",tabViewName:"tabViewName2",tabUrl:"/state2"}];scope.tabs=e,scope.$digest(),expect(t.find("md-icon").eq(0).text()).toBe(e[0].tabIcon),expect(t.find("md-label").eq(0).text()).toBe(e[0].tabName),expect(t.find("md-content").eq(0).attr("ui-view")).toBe(e[0].tabViewName)})}),function(){angular.module("components.core.dataList",[]).directive("abcDataList",e).controller("DataListController",t),e.$inject=[];function e(){return{restrict:"E",controller:"DataListController",templateUrl:"app/components/core/dataList/dataList.html",controllerAs:"dataList",scope:{},bindToController:{config:"=",data:"=",selected:"=?",enablePagination:"<?",orderByField:"=",pageSize:"=?",pageNumber:"=?",totalRecords:"<?",onPaginate:"&"}}}t.$inject=["$filter","$scope"];function t(e,t){var n=this;n.$onInit=function(){void 0==n.selected&&(n.selected=[]);n.filteredData=n.data,n.filter={value:"",options:{updateOn:"default blur",debounce:{default:200,blur:0}}},void 0==n.pageNumber&&(n.pageNumber=1);void 0==n.pageSize&&(n.pageSize=5)},n.paginate=function(){void 0!=n.onPaginate&&n.onPaginate()};n.removeFilter=function(){n.filter.show=!1,n.filter.value="",o(n.filter.value,n.orderByField),n.filter.form.$dirty&&n.filter.form.$setPristine()},n.filterChanged=function(e){n.config.onQuery&&n.config.onQuery(e,n.orderByField);o(e,n.orderByField)},n.orderByChanged=function(e){n.config.onQuery&&n.config.onQuery(n.filter.value,e);o(n.filter.value,e)};t.$watch(function(){return{data:n.data,orderField:n.orderByField}},function(e,t){e!==t&&o(n.filter.value,n.orderByField)},!0);function o(t,o){var i=e("filter")(n.data,t);i=e("orderBy")(i,o),n.filteredData=i}}}(),describe("Component.Core: dataList",function(){var e,t,n,o,i;beforeEach(module("components.core.dataList","templates")),beforeEach(module("shared.services.service","ngStorage","md.data.table","ngMaterial","pascalprecht.translate")),beforeEach(inject(function(r,a,c){scope=r.$new(),scope.config={},e=c;t=function(t){var n=angular.element("<body>"+t+"</body"),o=e(n)(scope);return scope.$digest(),o}('<abc-data-list config="config" data="data", selected="selected" order-field="orderField"></abc-data-list>'),n="dataList",o="abcDataList",i=t.isolateScope()})),it("expect template to be replaced",function(){expect(t.find("md-table-container").length).toBe(1)}),it("expect controller to be defined",function(){var e=t.controller(o);expect(e).toBeDefined()}),it("expect controllerAs name to be right",function(){expect(i.hasOwnProperty(n)).toBeTruthy()}),it('expect parameter: "config.title" to be set',function(){var e={title:"List Title"};scope.config=e;var t=i[n];expect(t.config.title).toBeUndefined(),scope.$digest(),expect(t.config.title).toBe(e.title)}),it("expect component to render the title",function(){var e={title:"List Title"};scope.config=e,scope.$digest(),expect(t.find("h2").text()).toBe(e.title)}),it('expect parameter: "config.enableFilter" to be set',function(){scope.config={enableFilter:!0};var e=i[n];expect(e.config.enableFilter).toBeUndefined(),scope.$digest(),expect(e.config.enableFilter).toBeDefined(),expect(e.config.enableFilter).toBe(!0)}),it("expect component to render the filter button based on enableFilter",function(){scope.config={enableFilter:!0},scope.$digest(),expect(t.find("md-icon").eq(0).text()).toBe("filter_list")}),it('expect parameter: "config.onQuery" to be set',function(){scope.config={onQuery:function(e){return e}},scope.$digest();var e=i[n];spyOn(e.config,"onQuery"),expect(e.config.onQuery.calls.count()).toBe(0),e.config.onQuery("filter","orderBy"),expect(e.config.onQuery).toHaveBeenCalled(),expect(e.config.onQuery.calls.count()).toBe(1),expect(e.config.onQuery).toHaveBeenCalledWith("filter","orderBy")}),it('expect parameter: "config" to be set',function(){scope.config={exist:!0};var e=i[n];expect(e.config.exist).toBeUndefined(),scope.$digest(),expect(e.config.exist).toBeDefined(),expect(e.config.exist).toBeTruthy}),it('expect parameter: "config.enableRowSelection" to work',function(){scope.config={enableRowSelection:!0};i[n];expect(t.find("th").eq(0).hasClass("md-checkbox-column")).toBe(!1),scope.$digest(),expect(t.find("th").eq(0).hasClass("md-checkbox-column")).toBe(!0)}),it('expect parameter: "data" to be set',function(){scope.data=[{id:1,name:"Name1",value:1},{id:2,name:"Name2",value:2}];var e=i[n];expect(e.data).toBeUndefined(),scope.$digest(),expect(e.data).toBeDefined(),expect(e.data.length).toBe(2)}),it('expect parameter: "config.columns" to render the headers in template right',function(){var e={columns:[{field:"id",displayName:"ID"},{field:"name",displayName:"Name"},{field:"value",displayName:"Value"}]};scope.config=e,scope.$digest(),expect(t.find("th").eq(0).text()).toBe(e.columns[0].displayName),expect(t.find("th").eq(1).text()).toBe(e.columns[1].displayName),expect(t.find("th").eq(2).text()).toBe(e.columns[2].displayName)}),it("expect data to render right ",function(){scope.config={columns:[{field:"id",isNumeric:!0,displayName:"ID"},{field:"name",isNumeric:!1,displayName:"Name"},{field:"value",isNumeric:!0,displayName:"Value"}]};var e=[{id:1,name:"Name1",value:1},{id:2,name:"Name2",value:2}];scope.data=e,scope.$digest(),expect(t.find("tbody").find("tr").eq(0).find("td").eq(0).html()).toBe(e[0].id.toString()),expect(t.find("tbody").find("tr").eq(0).find("td").eq(1).html()).toBe(e[0].name.toString()),expect(t.find("tbody").find("tr").eq(0).find("td").eq(2).html()).toBe(e[0].value.toString()),expect(t.find("tbody").find("tr").eq(1).find("td").eq(0).html()).toBe(e[1].id.toString()),expect(t.find("tbody").find("tr").eq(1).find("td").eq(1).html()).toBe(e[1].name.toString()),expect(t.find("tbody").find("tr").eq(1).find("td").eq(2).html()).toBe(e[1].value.toString())}),it('expect parameter: "orderField" to be set',function(){var e=i[n];expect(e.orderField).toBeUndefined(),scope.orderField="-name",scope.$digest(),expect(e.orderField).toBe("-name")}),it('expect "orderField" to order data by its value',function(){scope.config={columns:[{field:"id",isNumeric:!0,displayName:"ID"},{field:"name",isNumeric:!1,displayName:"Name"},{field:"value",isNumeric:!0,displayName:"Value"}]};var e=[{id:1,name:"Name1",value:1},{id:2,name:"Name2",value:2}];scope.data=e,scope.$digest(),expect(t.find("tbody").find("tr").eq(0).find("td").eq(0).html()).toBe(e[0].id.toString()),expect(t.find("tbody").find("tr").eq(1).find("td").eq(0).html()).toBe(e[1].id.toString()),scope.orderField="-id",scope.$digest(),expect(t.find("tbody").find("tr").eq(0).find("td").eq(0).html()).toBe(e[1].id.toString()),expect(t.find("tbody").find("tr").eq(1).find("td").eq(0).html()).toBe(e[0].id.toString())}),it('expect parameter: "config.itemMenu" to render a button with menus',function(){scope.config={columns:[{field:"id",isNumeric:!0,displayName:"ID"},{field:"name",isNumeric:!1,displayName:"Name"},{field:"value",isNumeric:!0,displayName:"Value"}],itemMenu:[{name:"edit",icon:"edit",ariaLabel:"edit",onClick:function(e){return{button:"edit",item:e}}},{name:"select",icon:"select",ariaLabel:"select",onClick:function(e){return{button:"select",item:e}}},{name:"delete",icon:"delete",ariaLabel:"delete",onClick:function(e){return{button:"delete",item:e}},msgConfirm:{textContent:"delete item"}}]};scope.data=[{id:1,name:"Name1",value:1},{id:2,name:"Name2",value:2}];i[n];expect(t.find("tbody").find("tr").eq(0).find("button").length).toBe(0),scope.$digest(),expect(t.find("tbody").find("tr").eq(0).find("button").length).toBe(4)})}),angular.module("components.core",["components.core.auth","components.core.authenticatedMenu","components.core.chooseLanguage","components.core.createTabs","components.core.dataList","components.core.login","components.core.signup"]),function(){angular.module("components.core.login",["shared.services.service.security"]).directive("login",function(){return{restrict:"E",controller:"LoginController",templateUrl:"app/components/core/login/login.html",controllerAs:"login"}}).controller("LoginController",e);e.$inject=["securityService"];function e(e){this.data={},this.login=e.login,this.closeLogin=e.closeLogin,this.loginReason=e.getLoginReason,this.loginError=e.getLastAuthError}}(),function(){angular.module("components.core.signup",["shared.services.service.user","shared.services.service.notification","shared.services.factory.handleException"]).component("swSignup",{templateUrl:"app/components/core/signup/signup.html",controller:e}),e.$inject=["userService","notificationService","handleExceptionFactory"];function e(e,t,n){this.form={},this.signup=function(o){e.save(o).then(function(e){t.show("success","SIGNUP.REGISTERED")},n)},this.teste=function(e){console.log(e)}}}(),function(){angular.module("components.cultura.culturaSelect",["shared.services.service.culture"]).component("abcCulturaSelect",{templateUrl:"app/components/cultura/culturaSelect/culturaSelect.html",controller:e,bindings:{id:"=",required:"<?"}}),e.$inject=["cultureService","$scope"];function e(e,t){var n=this;n.culturas=[],n.selectedItemChange=function(e,t){e?(e.strIdCultura!=n.id&&(n.id=e.strIdCultura),n.required&&t.$setValidity("required",!0)):(n.id=void 0,n.required&&t.$setValidity("required",!1))},n.$onInit=o;function o(){e.load().then(function(e){if(n.culturas=e,n.id){var t=_.findIndex(n.culturas,{strIdCultura:n.id});t>-1&&(n.selectedItem=n.culturas[t])}})}var i=e.onCultureChange(o);t.$on("$destroy",i),t.$watch(function(){return{id:n.id,required:n.required}},function(e,t){e!==t&&o()},!0)}}(),describe("Component.cultura: culturaSelect",function(){var e,t,n;beforeEach(module("components.cultura.culturaSelect","templates")),beforeEach(module("shared.services.service","ngStorage","ngMaterial","pascalprecht.translate")),beforeEach(inject(function(o,i,r,a){scope=o.$new(),scope.config={},e=r;n=function(t){var n=angular.element("<body>"+t+"</body"),o=e(n)(scope);return scope.$digest(),o}('<abc-cultura-select id="id" required="required"></abc-cultura-select>'),t="abcCulturaSelect",n.isolateScope(),$componentController=a})),it("expect template to be replaced",function(){expect(n.find("md-autocomplete").length).toBe(1)}),it("expect controller to be defined",function(){var e=n.controller(t);expect(e).toBeDefined()}),it("expect controller to be initialized",function(){var e=n.controller(t);expect(e.culturas.length).toBe(4)}),it("expect controller to be attached to the scope as $ctrl",function(){controller=$componentController(t,{$scope:scope}),expect(scope.$ctrl).toBe(controller)}),it('expect parameter: "id" to be set',function(){controller=n.controller(t),expect(controller.id).toBeUndefined(),scope.id="pt-br",scope.$digest(),expect(controller.id).toBe(scope.id),scope.id=void 0,scope.$digest(),expect(controller.id).toBeUndefined()}),it('expect parameter: "required" to be set',function(){controller=n.controller(t),expect(controller.required).toBeUndefined(),scope.required=!0,scope.$digest(),expect(controller.required).toBe(scope.required),scope.required=void 0,scope.$digest(),expect(controller.required).toBeUndefined()}),it('expect parameter: "id" to configure selected value in the list',function(){controller=n.controller(t),scope.id="pt-BR",scope.$digest(),expect(controller.searchText).toBe("CULTURA.PORTUGUES"),scope.id="en-US",scope.$digest(),expect(controller.searchText).toBe("CULTURA.INGLES")})}),angular.module("components.cultura",["components.cultura.culturaSelect"]),function(){angular.module("components.engineer.engineer.form",["shared.services.factory.handleException","shared.services.service.engineer","shared.services.service.viewstate","shared.services.service.notification"]).component("swEngineerForm",{templateUrl:"app/components/engineer/engineer.form/engineer.form.html",controller:e,bindings:{id:"<?"}}),e.$inject=["handleExceptionFactory","viewstateService","notificationService","engineerService","$location"];function e(e,t,n,o,i){var r=this;r.data=t.getView("Engineer"),r.$onInit=function(){void 0!=r.id&&o.load({intIdEngineer:r.id}).then(function(e){void 0==e.intIdEngineer?(n.show("error","GENERAL.ERROR-NOTFOUND"),t.newView("Engineer"),i.path("restrict/engineer")):r.form=e}).catch(e)},r.save=function(t){var r=angular.copy(t);o.save(r).then(function(e){n.show("success","GENERAL.SAVED-SUCCESSFULLY"),i.path("restrict/engineer/"+e.intIdEngineer)},e)},r.remove=function(r){o.remove({intIdEngineer:r}).then(function(e){n.show("success","GENERAL.REMOVED-SUCCESSFULLY"),t.newView("Engineer"),i.path("restrict/engineer")},e)},r.newEngineer=function(){t.newView("Engineer"),i.path("restrict/engineer")}}}(),function(){angular.module("components.engineer.engineer.list",["shared.services.factory.handleException","shared.services.service.engineer","shared.services.service.viewstate","shared.services.service.notification"]).component("swEngineerList",{templateUrl:"app/components/engineer/engineer.list/engineer.list.html",controller:e,bindings:{}}),e.$inject=["handleExceptionFactory","viewstateService","notificationService","engineerService","$scope","$location"];function e(e,t,n,o,i,r){var a=this;a.data=t.getView("engineerList"),a.data.engineers=a.data.engineers||[],a.$onInit=function(){a.config={enableFilter:!1,enableRowSelection:!1,columns:[{field:"strNameEngineer",isNumeric:!1,displayName:'{{"ENGINEER-LIST.NAME" | translate }}'}],itemMenu:[{name:'{{"GENERAL.SELECT" | translate }}',icon:"edit",ariaLabel:'{{"GENERAL.SELECT" | translate }}',onClick:a.selectEngineer}]};var e=o.listenEvent.both.all(function(){if(a.data.searched){var e=angular.copy(a.data);e.cache=!1,e.applyScope=!0,c(e)}});i.$on("$destroy",e);c(a.data)},a.selectEngineer=function(e){var e=e.item;r.path("/restrict/engineer/"+e.intIdEngineer)};function c(t){var n=angular.copy(t);delete n.engineers,void 0==n.cache&&(n.cache=!0),o.load(n).then(function(e){a.data.engineers=e,a.data.searched=!0}).catch(e)}}}(),angular.module("components.engineer",["components.engineer.engineer.form","components.engineer.engineer.list"]),function(){angular.module("components.home",[]).component("swHome",{templateUrl:"app/components/home/home.html",controller:function(){},bindings:{}})}(),angular.module("components",["components.core","components.cultura","components.about","components.home","components.listWeekCards","components.engineer","components.wheel"]),function(){angular.module("components.listWeekCards",["shared.services.service.schedule","shared.services.value.constantes"]).component("swListWeekCards",{templateUrl:"app/components/listWeekCards/listWeekCards.html",controller:e,bindings:{}}),e.$inject=["scheduleService","constEventosDb","$scope","$timeout"];function e(e,t,n,o){var i=this;i.scheduleShifts=[],i.$onInit=function(){e.load().then(function(e){i.scheduleShifts=e,angular.forEach(i.scheduleShifts,function(e,t){var n=r(new Date(e.dteSchedule));e.weekNumber=n,e.weekDay=new Date(e.dteSchedule).getDay()})});var a=e.listenEvent.both.inserted(function(e){if(e.type=t.INSERTED){o(function(){!function(e){e.data.weekNumber=r(new Date(e.data.dteSchedule)),e.data.weekDay=new Date(e.data.dteSchedule).getDay(),i.scheduleShifts.push(e.data),n.$apply()}(e)}.bind(this),11e3)}});n.$on("$destroy",a)};function r(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var t=new Date(Date.UTC(e.getUTCFullYear(),0,1)),n=("0"+Math.ceil(((e-t)/864e5+1)/7)).slice(-2);return e.getUTCFullYear()+"/"+n}}}(),function(){angular.module("components.wheel",["shared.services.service.engineer","shared.services.factory.handleException","shared.services.service.schedule","shared.services.service.notification","shared.services.value.constantes"]).component("swWheel",{templateUrl:"app/components/wheel/wheel.html",controller:e,styleUrls:["app/components/wheel/wheel.css"],bindings:{}}),e.$inject=["handleExceptionFactory","engineerService","scheduleService","notificationService","$scope","constEventosDb","$timeout"];function e(e,t,n,o,i,r,a){var c=this;c.engineersNames=[],c.engineers=[],c.draftEngineer={},c.$onInit=function(){function o(){t.load({cache:!1}).then(function(e){c.engineers=e,c.engineerNames=[];for(var t=0;t<e.length;t++)c.engineersNames.push(e[t].strNameEngineer);Q.setWords(c.engineersNames),Q.drawWheel()}).catch(e),n.load({intPageSize:1,intPageNumber:1}).then(function(e){e.length>0?(c.lastDate=e[0].dteSchedule,c.lastPeriod=e[0].intPeriod,c.lastEngineer=e[0].strNameEngineer,c.lastDraftBy=e[0].strFullNameCreated):(c.lastDate=new Date,c.lastPeriod=1)})}var s=t.listenEvent.both.all(o);i.$on("$destroy",s),o();var l=n.listenEvent.hub.inserted(function(e){if(e.type=r.INSERTED){a(function(){(t=e).data.dteSchedule>=c.lastDate&&(c.lastDate=t.data.dteSchedule,c.lastPeriod=t.data.intPeriod,c.lastEngineer=t.data.strNameEngineer,c.lastDraftBy=t.data.strFullNameCreated,i.$apply());var t}.bind(this),14e3)}});i.$on("$destroy",l)},c.startSpinning=function(){var e=0;for(;e<.4;)e=Math.random();Q.spin(e)};function s(){c.spinning=!0,c.draftEngineer={},m.bind("update",l),n.save({dteSchedule:c.lastDate,intPeriod:c.lastPeriod}).then(function(e){c.draftEngineer=e,function(){for(var e=angular.copy(u.rotation),t=angular.copy(p);p>.005;)u.rotation=(u.rotation+p*$)%v,p*=E;for(p=angular.copy(t);T()!=c.draftEngineer.strNameEngineer;)p*=p/(p*E),u.rotation=(u.rotation+p*$)%v;u.rotation=e}()},e)}function l(){u.rotation=(u.rotation+p*$)%v,p<=.4?void 0!==c.draftEngineer.strNameEngineer&&(p*=E):p*=E,d(u.rotation),p<.005&&(c.spinning=!1,m.unbind("update",l),c.lastDate=c.draftEngineer.dteSchedule,c.lastPeriod=c.draftEngineer.intPeriod,c.lastEngineer=c.draftEngineer.strNameEngineer,c.lastDraftBy=c.draftEngineer.strFullNameCreated,i.$apply(),o.show("success","WHEEL.SUCCESS-SAVED"))}function d(e){L.onWheelTick&&"function"==typeof L.onWheelTick&&L.onWheelTick(e)}var u,p,f,m,g,h=["#f7d046","#ff4c5a","#f08cba","#49c4d2","#924e84","#fd926f","#245a65","#ff6a76","#633d89","#3cb878","#ee1c24","#f6989d","#00aef0","#f26522","#fff200","#e70697","#000000"],b=Math.PI,v=2*b,x=function(e){return e/180*b},y={mousedown:D,touchstart:D,mousemove:R,touchmove:R,mouseup:V,touchend:V},w={tickerRadius:.06,textSize:.12,edgeDist:.14},S=function(e,t,n){var o=n.cx,i=n.cy;return{x:o+e*Math.cos(t),y:i+e*Math.sin(t)}},E=.99,N=.5,$=1,B=!1,C=[],L={width:240,height:240,type:"svg"};function T(){var e=f.length,t=v/e,n=(v-u.rotation+t/2)%v;return f.find(function(e,o){return t*(o+1)>n})}function D(e){A(e);var t=u._renderer.elem;B=t===e.target||t.contains(e.target),C=B?C.concat(k(e)):C,g=performance.now()}function U(e){f=e}function q(e,t){m.renderer.domElement.setAttribute("viewBox","0 0 "+e+" "+t)}function I(){var e=m.width,t=w.tickerRadius*e,n=function(e){var t=m.width,n=m.makeArcSegment(t/2,e,e,.5*e,0,2*b);return n.noStroke(),n}(t).translation;!function(e,t,n){var o=n.x,i=n.y,r=S(e,b/2,{cx:o,cy:i}),a=S(e,t,{cx:o,cy:i}),c={x:o,y:i+e/Math.cos(b/2-t)},s=S(e,b-t,{cx:o,cy:i}),l=m.makePath(r.x,r.y,a.x,a.y,c.x,c.y,s.x,s.y);l.noStroke(),l.fill="#3f51b5"}(t,x(30),n)}function F(){u&&W();var e=m,t=e.width,n=(e.height,h.length),o=2*b/f.length,i=t*w.tickerRadius*2,r=(t-i)/2,a={x:t/2,y:r+i};u=m.makeGroup(),f.map(function(e,t,i){var c=o*t-(b+o)/2,s=m.makeArcSegment(a.x,a.y,0,r,0,2*b/i.length);s.rotation=c,s.noStroke(),s.fill=h[t%n];var l={x:a.x+(r-r*w.edgeDist)*Math.cos(c+o/2),y:a.y+(r-r*w.edgeDist)*Math.sin(c+o/2)},d=m.makeText(e,l.x,l.y);d.rotation=o*t-b/2,d.alignment="right",d.fill="#fff",d.size=r*w.textSize,u.add(s,d)}),u.translation.set(a.x,a.y),u.center(),I(),m.update()}function M(){q(m.width,m.height),F(),I(),m.update()}function V(e){if(B&&C.length>1){var t=k(e),n=C[C.length-2],o=performance.now()-g,i=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));if((p=Math.min(i/o,N))<.4)return;s()}C=[],B=!1}function k(e){var t=A(e);return{x:t.clientX,y:t.clientY}}function A(e){return e.changedTouches?e.changedTouches[0]:e}function R(e){if(B&&C.length){e.preventDefault(),g=performance.now();var t=(C=C.concat(k(e)))[C.length-1],n=C[C.length-2],o=u._renderer.elem.getBoundingClientRect(),i=o.left+o.width/2,r=o.top+o.height/2,a=Math.atan2(n.y-r,n.x-i),c=Math.atan2(t.y-r,t.x-i)-a;$=c>0?1:-1,u.rotation=(u.rotation+c)%v,d(u.rotation),m.update()}}function P(e){p=e,s()}function j(e){var t=e.height,n=e.width;m.width=parseInt(n,10),m.height=parseInt(t,10),m.trigger("resize")}function W(){u.remove.apply(u,u.children),m.clear()}function z(){return W(),function(){var e=m.renderer.domElement;m.unbind("update"),Object.keys(y).map(function(t){return e.removeEventListener(t,y[t])})}(),!0}var O=document.querySelector(".js-mount"),Q=(document.querySelector(".js-get-word"),document.querySelector(".js-spin"),document.querySelector(".js-words"),function(e){if(!(e&&"nodeType"in e))throw new Error("no mount element provided");return{destroy:z,drawWheel:F,getCurrentWord:T,init:function(t){L=Object.assign({},L,t),m=new Two({type:Two.Types[L.type],width:L.width,height:L.height}).bind("resize",M).play(),function(){var e=m.renderer.domElement;Object.keys(y).map(function(t){return e.addEventListener(t,y[t])})}(),m.appendTo(e),q(L.width,L.height),m.renderer.domElement.setAttribute("style","\n        -moz-user-select:none;\n        -ms-user-select:none;\n        -webkit-user-select:none;\n        user-select:none;\n        -webkit-tap-highlight-color: rgba(0,0,0,0);\n      ")},setWords:U,spin:P,updateDims:j}}(O));Q.init({width:Math.min(window.innerWidth,window.innerHeight),height:Math.min(window.innerWidth,window.innerHeight)}),Q.setWords(c.engineersNames),Q.drawWheel();window.addEventListener("resize",function(){Q.updateDims({width:Math.min(window.innerWidth,window.innerHeight),height:Math.min(window.innerWidth,window.innerHeight)})})}}(),angular.module("App",["ngAnimate","ngResource","ngSanitize","angular-loading-bar","shared","components","ui.router","ngStorage","angular-jwt","ngMaterial","ngMessages","SignalR","pascalprecht.translate","md.data.table","angular.filter"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,n){t.otherwise("/"),t.rule(function(e,t){var n=/(.+)(\/+)(\?.*)?$/,o=t.url();return!(!o||!n.test(o))&&o.replace(n,"$1$3")}),n.html5Mode(!0).hashPrefix("!")}]).config(function(e){e.theme("default").foregroundPalette[3]="rgba(0,0,0,0.67)"}).config(["$localStorageProvider",function(e){e.setKeyPrefix("SupportWheel")}]).config(["$httpProvider",function(e){e.interceptors.push("interceptorFactory")}]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"app/locales/",suffix:".json"}).registerAvailableLanguageKeys(["en","es","fr","pt"],{"en-US":"en","es-ES":"es","fr-FR":"fr","pt-BR":"pt"}).useSanitizeValueStrategy("sanitizeParameters")}]).run(function(e,t,n){t.get("app/shared/views/formMessages.html").then(function(t){e.put("form-messages",t.data)}),n.$on("$stateChangeError",function(e,t,n,o,i,r){console.error(r)})}),angular.element(function(){angular.bootstrap(document,["App"])});